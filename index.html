<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Spotify Logger & Playlist Tools</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <div class="wrap">
    <h1>Spotify Logger & Playlist Tools</h1>
    <p class="lead">Log plays in your browser, export CSV, and maintain an “All My Songs (Auto)” playlist + artist playlists.</p>

    <div class="toolbar">
      <button id="login">Log in with Spotify</button>
      <button id="logout">Log out</button>
      <button id="downloadCsv">Download CSV</button>
      <span class="status">Status: <span id="status" class="badge">Not authenticated</span></span>
    </div>

    <div class="panel grid">
      <div>
        <h3>Live Logger</h3>
        <p class="small">Keeps a local tally; backfills up to the last ~50 plays on load.</p>
        <pre id="log">(no data yet)</pre>
      </div>
      <div>
        <h3>Aggregate Playlist</h3>
        <p class="small">Creates/updates <b>“All My Songs (Auto)”</b> with every unique track from playlists you own.</p>
        <div class="toolbar" style="padding-left:0">
          <button id="createAggregate">Create “All My Songs (Auto)”</button>
          <button id="updateAggregate">Update (add missing)</button>
          <button id="syncStrict">Sync (add & remove)</button>
        </div>
        <pre id="agglog">(nothing yet)</pre>
      </div>
    </div>

    <div class="panel">
      <h3>Artist Playlists</h3>
      <p class="small">Treats each playlist name as an artist (case-insensitive, accent-insensitive).</p>
      <div class="toolbar" style="padding-left:0">
        <button id="syncArtistPlaylists">Sync artist playlists (needs ≥5 in “All My Songs”)</button>
        <button id="findMissingArtistPlaylists">Find artists (≥7) without a playlist</button>
      </div>
      <pre id="artistlog">(nothing yet)</pre>
    </div>

    <p class="small">Tip: This is a client-side app. Data stays in your browser storage. Clear it by removing site data for this origin.</p>
  </div>

  <!-- Use native ES modules; no bundler required -->
  <script type="module" src="./js/main.js"></script>
</body>
</html>
